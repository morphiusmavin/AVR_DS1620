// test the return raw values of DS1620 (0xFA -> 0x192)
// in both F and C

#include <stdio.h>

float convert_to_T_F(int raw_data);

int f_or_c = 1;	// gets F degrees
//int f_or_c = 0;	// get C degrees

int main(void)
{
	float tf;
	int i;
	int raw;
	
	raw = 0x00FA;
	do
	{
		tf = convert_to_T_F(raw);
		printf("%f %02x\n",(double)tf,raw);
		raw++;
	}while(raw < 0x0192);
}

float convert_to_T_F(int raw_data)
{
	float T_F, T_celcius;
	if ((raw_data & 0x100) != 0)
	{
		raw_data = - (((~raw_data)+1) & 0xff); /* take 2's comp */   
	}
	T_celcius = raw_data * 0.5;
	if(f_or_c == 1)
	{
		T_F = (T_celcius * 1.8) + 32;
		return(T_F);	// returns 257 -> -67
	}
	else return(T_celcius);	// returns 125 -> -55
}


/*	F values returned:

257.000000 fa
257.899994 fb
258.799988 fc
259.700012 fd
260.600006 fe
261.500000 ff
32.000000 100
-197.500000 101
-196.600006 102
...
-74.199997 18a
-73.300003 18b
-72.400002 18c
-71.500000 18d
-70.599998 18e
-69.699997 18f
-68.800003 190
-67.900002 191

C values returned:

125.000000 fa
125.500000 fb
126.000000 fc
126.500000 fd
127.000000 fe
127.500000 ff
0.000000 100
-127.500000 101
...
-59.000000 18a
-58.500000 18b
-58.000000 18c
-57.500000 18d
-57.000000 18e
-56.500000 18f
-56.000000 190
-55.500000 191

*/

